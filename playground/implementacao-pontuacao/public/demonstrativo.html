<html>
    <head>
        <meta charset="utf-8">
        <title></title>

        <style>
            table, td {
            
  border: 2px solid black;

}
            body {
                margin: 40px 0 0 0;
                padding: 0;
                background-color: #EEE;
                text-align: center;
                
            }
            
            #valorx {
                position: absolute;
                top: 25px;
                left: 550px;
            }
            #cx {
                position: absolute;
                top: 400px;
                left: 550px;
            }
            #fx {
                position: absolute;
                top: 75px;
                left: 550px;
            }
            #ck {
                position: absolute;
                top: 300px;
                left: 550px;

            }
            #fk {
                position: absolute;
                top: 350px;
                left: 550px;
            }
            #usuario {
                position: absolute;
                top: 650px;
                left: 550px;
            }
            #senha {
                position: absolute;
                top: 675px;
                left: 550px;
            }
            #bsenha { 
                position: absolute;
                top: 700px;
                left: 550px;
            }
            #valory {
                position: absolute;
                top: 225px;
                left: 550px;
            }
            #by {
                position: absolute;
                top: 250px;
                left: 550px;
            }
            #bsend {
                position: absolute;
                top: 600px;
                left: 550px;
            }

           </style>
           <table id="myTable">
            <tr>
                <td>  
                    Receita de Vendas
                </td>
                <td>36917400 $</td>
                <td>100%</td>
            </tr>
            <tr>
                <td>Modelos</td>
                <td>147</td>
                <td>157</td>
            </tr>
            <tr>
                <td>Preço Unitário</td>
                <td>288$</td>
                <td>324$</td>
            </tr>
            <tr>
                <td>Custo de Fabricação</td>
                <td>21003900$</td>
            </tr>
            <tr>
                <td>Preço Médio</td>
                <td>544 $</td>
            </tr>

            <tr>
                <td>Estoque Inicial</td>
                <td> 0</td>
            </tr>
            <tr>
                <td>Custo Estocagem (36$ unit.)</td>
                <td>200700$</td>
            </tr>
            <tr>
                <td>Custo Alteração</td>
                <td>0</td>
            </tr>
            <tr>
                <td>Hora Extra</td>
                <td>297900$</td>
            </tr>
            <tr>
                <td>Total em Disponibilidade</td>
                <td>21504500$</td>
            </tr>
            <tr>
                <td>Estoque Final</td>
                <td>-283680$</td>
            </tr>
            <tr>
                <td># Estoque Final</td>
                <td>985</td>
            </tr>
            </tr>
            <tr>
                <td>CMV</td>
                <td> 21218820 $</td>
                <td> 57.48%</td>
            </tr>
            <tr>
                <td>Margem Bruta</td>
                <td> 15698580$</td>
                <td>42.52%</td>
            </tr>
            <tr>
                <td>Margem Bruta Total</td>
                <td> 15698580$</td>
                <td>42.52%</td>
            </tr>
            <tr>
                <td>Total Unidades Vendidas</td>
                <td> 68640</td>  
            </tr>
            <tr>
                <td>Despesas Operacionais</td>
                <td>Despesas Administrativas</td>
                <td>4320000$</td>
                <td>Unitário</td>
                <td>720000$</td>
            </tr>
            <tr>
                <td>Força de Vendas</td>
                <td># Venderores</td>
                <td>40</td>
                <td>Comissão</td>
                <td>0.05</td>
            </tr>
            <tr>
                <td>Salários</td>
                <td>518400$</td>
            </tr>
            <tr>
                <td>Comissões</td>
                <td>1845870$</td>
                <td>Salário Unitário</td>
                <td>2160$</td>
            </tr>
            <tr>
                <td>Total Força de vendas</td>
                <td>2364270$</td>
                <td>Comissão por venda</td>
                <td>34 $</td>
            </tr>
            <tr>
                <td>Propaganda</td>
                <td>Intitucional</td>
                <td>780000$</td>
            </tr>
            <tr>
                <td></td>
                <td>Produtos</td>
                <td>1149600 $</td>
                <td>Por produto</td>
                <td>28$</td>
            </tr>
            <tr>
                <td>Total Propaganda</td>
                <td>1929600$</td>
            </tr>
            <tr>
                <td>Depreciação Máquinas</td>
                <td>1152000</td>
                <td>eríodo de depreciação (anos)</td>
                <td>15</td>
                <td>Valor Unitário</td>
                <td>192000$</td>
            </tr>
            <tr>
                <td>Juros sobre Empréstimos</td>
                <td>23040$</td>
                <td>Taxa de juros</td>
                <td>0.08</td>
            </tr>
            <tr>
                <td>Transporte</td>
                <td># Motoristas</td>
                <td>10</td>
            </tr>
            <tr>
                <td>Salários</td>
                <td>288000</td>
                <td>Salário Unitário</td>
                <td>4800$</td>
            </tr>
            <tr>
                <td>Lubrificação e Manutenção</td>
                <td>360000$</td>
                <td>Manutenção (unit.)</td>
                <td>6000$</td>
            </tr>
            <tr>
                <td>Depreciação de veículos</td>
                <td>144000$</td>
                <td>Valor do veículo</td>
                <td>57600$</td>
            </tr>
            <tr>
                <td>Frota de Terceiros</td>
                <td>0</td>
                <td>Depreciação (em anos)</td>
                <td>4</td>
            </tr>
            <tr>
                <td>Total</td>
                <td>792000$</td>
            </tr>
            <tr>
                <td>Despesas com Varejistas</td>
                <td>Unitário</td>
                <td>360$</td>
                <td># Varejistas</td>
                <td>640</td>

            </tr>
            <tr>
                <td>Total Varejistas</td>
                <td>1382400$</td>
            </tr>
            <tr>
                <td>Assistência Técnica</td>
                <td># Oficinas</td>
                <td>30</td>
                <td>Custo Unitário</td>
                <td>2160$</td>
                <td>Custo fixo</td>
                <td>50400$</td>
            </tr>
            <tr>
                <td>Total Assistência</td>
                <td>691200$</td>
            </tr>
            <tr>
                <td>Pesquisa</td>
                <td>0$</td>
            </tr>
            <tr>
                <td>Total Despesas Operacionais</td>
                <td>12654510$</td>
                <td>34.28%</td>
                <td>184$</td>
            </tr>
            <tr>
                <td>LUcro ou Prejuízo Antes do I.R</td>
                <td>3044070$</td>
                <td>8.25%</td>
            </tr>
            <tr>
                <td>Imposto de renda</td>
                <td>913221$</td>
            </tr>
            <tr>
                <td>Lucro Líquido ou Prejuízo</td>
                <td>2130849</td>
                <td>5.77%</td>
            </tr>
          </table>
    

        
        <div>
            <button type="button" id="ck" onclick="eventok()">Pesquisar quantitade de PAS da concorrencia</button>
            <button type="button" id="fk" onclick="parareventok()">Pesquisar quantitade de distribuidores da concorrencia</button>
        </div>
</div>
        <script src="/socket.io/socket.io.js"></script>
    </head>
    <body>

        <script>
            let duplo = 0
            function update(dados) {
                var table = document.getElementById("myTable");
                for(let i = 0; i < dados.length - 6; i++){
                
                table.rows[i+1].cells[1].innerHTML = dados[i][0]; // injeta o numero de insumos de cada servico na tabela do client
                table.rows[i+1].cells[2].innerHTML = dados[i][2]; // msm coisa /\ so q injeta os custos unitarios
                table.rows[i+1].cells[3].innerHTML = dados[i][0]*dados[i][2];
                if(dados[i][1] == 1){
                    table.rows[i+1].cells[0].style.backgroundColor = "green";

                }
            }
            table.rows[23].cells[0].innerHTML = dados[21] //taokeys
            table.rows[22].cells[0].style.backgroundColor = "gray"
            table.rows[25].cells[0].innerHTML = dados[24] //comissao
            table.rows[24].cells[0].style.backgroundColor = "gray"
            table.rows[25].cells[3].innerHTML = dados[26] //pas
            table.rows[24].cells[3].style.backgroundColor = "gray"
            table.rows[23].cells[1].innerHTML = dados[22] //frota
            table.rows[22].cells[1].style.backgroundColor = "gray"
            table.rows[25].cells[1].innerHTML = dados[25] //distribuidores
            table.rows[24].cells[1].style.backgroundColor = "gray"
            table.rows[23].cells[2].innerHTML = dados[23] //promotores
            table.rows[22].cells[2].style.backgroundColor = "gray"
        }
            function tabela(dados) {
            var table = document.getElementById("myTable");
            //var row = table.insertRow(0);
            while(duplo == 0){
            for(let i = 0; i < dados.length - 6; i++){
                
                table.rows[i+1].cells[1].innerHTML = dados[i][0]; // injeta o numero de insumos de cada servico na tabela do client
                table.rows[i+1].cells[2].innerHTML = dados[i][2]; // msm coisa /\ so q injeta os custos unitarios
                table.rows[i+1].cells[3].innerHTML = dados[i][0]*dados[i][2];
                if(dados[i][1] == 1){
                    table.rows[i+1].cells[0].style.backgroundColor = "green";

                }
                //table.rows[i+1].cells[2].innerHTML = dados[i][1];
                //table.rows[i+1].cells[2].innerHTML = dados[i][2];
                table.rows[i+1].cells[0].addEventListener('click', function(i){
                    alert(i +" fazer algo")
            })
                table.rows[i+1].cells[1].addEventListener('click', function(i){
                    alert(i+ " fazer outro algo")
            })  
                table.rows[i+1].cells[2].addEventListener('click', function(i){
                    alert(i+ " fzer mais algum algo")
            })
                table.rows[i+1].cells[4].addEventListener('click', function(i){
                    alert(i+ " fzer mais algum algo alem daquilo")
            })
                
            }
            table.rows[23].cells[0].innerHTML = dados[21] //taokeys
            table.rows[22].cells[0].style.backgroundColor = "gray"
            table.rows[25].cells[0].innerHTML = dados[24] //comissao
            table.rows[24].cells[0].style.backgroundColor = "gray"
            table.rows[25].cells[3].innerHTML = dados[26] //pas
            table.rows[24].cells[3].style.backgroundColor = "gray"
            table.rows[23].cells[1].innerHTML = dados[22] //frota
            table.rows[22].cells[1].style.backgroundColor = "gray"
            table.rows[25].cells[1].innerHTML = dados[25] //distribuidores
            table.rows[24].cells[1].style.backgroundColor = "gray"
            table.rows[23].cells[2].innerHTML = dados[23] //promotores
            table.rows[22].cells[2].style.backgroundColor = "gray"

            

            duplo = duplo + 1
        }
}

            //se o <script n estiver com o type="module" o index.html fica incapaz de puxar os dados dos imports requisitados
        
            const socket = io()
            socket.on('connect', () => {
                const playerId = socket.id
                // console.log(`Player connected on Client with id: ${playerId}`)
                // console.log('socket', socket)
            })

            socket.on('disconnect', () => {
                //console.log('Unsubscribing All')
                //keyboardListener.unsubscribeAll();
            })
            socket.on('dados-servicos', (dados) => {
                tabela(dados)
            })
            socket.on('update', (dados) => {
                update(dados)
            })
            function send() {
        alert('Operacao Negada')
    }
            socket.on('setup', (state) => {
                
            })
            socket.on('login-negado', (cre) => {
                alert('login negado para tentativa de conexao com '+cre)
            })
            socket.on('operacao-negada', (motivo) => {
                alert('Operacao negada por ' + motivo)
            })
            socket.on('resposta-pesquisar-pas', () =>{
                alert('resultado: x')
            })
            socket.on('acesso-negado', () => {
                alert('Realize login para efetuar essa operacao')
            })
            socket.on('ja-conectado', (idd) => {alert('Voce ja esta conectado ' + idd)})
            socket.on('login-aprovado', (cre) => {
                alert('login aprovado para ' + cre)
            })
            function eventox() {
                socket.emit('alterar-porcetagem-comissao', 43)
                 }
            function sety() {
                socket.emit('alterar-porcetagem-comissao', 43)
                }
            function eventok() {
                socket.emit('pesquisar-pas', 43)
            }
            function parareventok() {
                socket.emit('alterar-porcetagem-comissao', 43)
            }
            function login() {
                let valor1 = document.getElementById("usuario").value
                let valor2 = document.getElementById("senha").value
                let valor = [valor1, valor2]
                socket.emit('login-client', valor)
                document.getElementById("usuario").value = ''
                document.getElementById("senha").value = ''

            }
        </script>
    </body>
</html>